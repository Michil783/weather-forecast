---
import {
	IconDroplet,
	IconGauge, 
	IconBattery1Filled,
	IconBattery2Filled,
	IconBattery3Filled,
	IconBattery4Filled,
} from "@tabler/icons-react";

const {
    isNight,
} = Astro.props;

const env = import.meta.env;
const weathernode2 = env.WEATHERNODE2;
const weathernode3 = env.WEATHERNODE3;

const insideResponse = await fetch (
	`${weathernode2}`
);
const insideData = await insideResponse.json();
//console.log(insideData);

const inside2Response = await fetch (
	`${weathernode3}`
);
const inside2Data = await inside2Response.json();

---

<div id="inside" class:list={[
        "col-span-3 items-center gap-8 shadow-md rounded-lg pt-4 backdrop-blur-lg backdrop-saturate-150 border h-full justify-center",
        {
            [`bg-[rgba(17,25,39,0.5)] border-white/10 text-slate-100`]:
                isNight,
            [`bg-[rgba(245,245,244,0.75)] border-black/10 text-slate-900`]:
                !isNight,
        },
    ]}>
    <div class="flex-col items-center justify-evenly self-stretch text-center">
        <!-- inside temp -->
        <div class="">
            <p class="text-[12rem]/33 font-semibold">
                {parseFloat(insideData.temp, (insideData.temp >= 10 ? 3 : 2))}째C
            </p>
        </div>
        <!-- heatindex, humnidity, pressure-->
        <div class="w-full pt-8 grid grid-cols-3 justify-center pl-4 pr-4">
            <!-- heatindex -->
            <div class="flex">
                <div class="flex items-start justify-start">
                    <div
                        class="flex flex-col items-start w-full">
                        Gef체hlt:
                        <span class="text-4xl font-bold">
                            {insideData.heat}째C
                        </span>
                    </div>
				</div>
            </div>

            <!-- humidity -->
            <div class="flex items-center justify-center">
                <div class="flex items-center">
                    <div
                        class="flex flex-col w-full">
                        Luftfeuchtigkeit:
                        <span class="text-4xl font-bold">
                            {insideData.hum}%
                        </span>
                    </div>
				</div>
            </div>

            <!-- outside pressure -->
            <div class="flex items-end justify-end">
                <div class="flex items-end">
                    <div class="flex flex-col items-center w-full">
                        Luftdruck:
                        <span class="text-4xl font-bold items-end justify-end">
                            {insideData.pres} hPa
                        </span>
                    </div>
				</div>
            </div>
        </div>

        <!-- battery room date -->
        <div class="w-full grid grid-cols-5 text-xl gap-x-8 font-semibold pl-4 pr-4">
            <!-- battery voltage and soc -->
            <div class="flex gap-2 col-span-2 items-start justify-start">
                { insideData.soc > 80 ? <span style="color:green"><IconBattery4Filled size={30} /></span> :
                    insideData.soc > 60 ? <span style="color:#ebb134"><IconBattery3Filled size={30} /></span> :
                    insideData.soc > 40 ? <span style="color:#eb7134"><IconBattery2Filled size={30} /></span> :
                    <span style="color:red"><IconBattery1Filled size={30} /></span> }
                
                <div
                    class="flex flex-col w-full">
                    <span class="text-2xl font-bold">
                        {insideData.volt}V / {insideData.soc}%
                    </span>
                </div>
            </div>
            <!-- Room -->
            <div class="flex gap-2 items-center justify-center">
                <div
                    class="flex flex-col justify-center items-center w-full">
                    <span class="text-2xl font-bold">
                        Wohnzimmer
                    </span>
                </div>
            </div>
            <!-- date and time of data -->
            <div class="flex items-end justify-end gap-2 col-span-2">
                <div
                    class="flex flex-col justify-end items-end w-full ">
                    <span class="text-s">
                        {insideData.time}
                    </span>
                </div>
            </div>
        </div>

        <!-- battery room date  2nd room -->
        <div class="w-full grid grid-cols-5 text-xl gap-x-8 font-semibold pl-4 pr-4">
            <!-- battery voltage -->
            <div class="flex gap-2 col-span-2 item-start justify-start">
                { inside2Data.soc > 80 ? <span style="color:green"><IconBattery4Filled size={20} /></span> :
                    inside2Data.soc > 60 ? <span style="color:#ebb134"><IconBattery3Filled size={20} /></span> :
                    inside2Data.soc > 40 ? <span style="color:#eb7134"><IconBattery2Filled size={20} /></span> :
                    <span style="color:red"><IconBattery1Filled size={20} /></span> }
                <div
                    class="flex flex-col w-full">
                    <span class="text-base font-bold">
                        {inside2Data.volt}V / {inside2Data.soc}% / {inside2Data.temp}째C
                    </span>
                </div>
            </div>
            <div class="flex gap-2 item-center justify-center">
                <div
                    class="flex flex-col justify-center items-center w-full">
                    <span class="text-base font-bold">
                        Schlafzimmer
                    </span>
                </div>
            </div>
            <!-- date and time of data -->
            <div class="flex items-end justify-end gap-2 col-span-2">
                <div
                    class="flex flex-col justify-end items-end w-full ">
                    <span class="text-base">
                        {inside2Data.time}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>
